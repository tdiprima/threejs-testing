<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Text Input Example</title>
  <!-- Needs work. -->
  <style>
    body { margin: 0; }
    canvas { display: block; }
  </style>
</head>
<body>
<!-- <input id="text-input" placeholder="Type your text here" type="text"> -->
<input id="text-input" name="text-input" type="text" value="Yabba Dabba Doo!">
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
<script>
  // Initialize variables
  let scene, camera, renderer, mouse, raycaster;
  let textObjects = [];
  // let fontUrl = "https://threejs.org/examples/fonts/helvetiker_regular.typeface.json";
  let fontUrl = "helvetiker_regular.typeface.json";

  // Function to create a new text object
  function createTextObject(text, x, y) {
    const loader = new THREE.FontLoader();
    loader.load(fontUrl, function (font) {
      const geometry = new THREE.TextGeometry(text, {
        font: font,
        size: 5,
        height: 0.2
      });

      const material = new THREE.MeshBasicMaterial({ color: 0xffffff });
      const textMesh = new THREE.Mesh(geometry, material);
      textMesh.position.set(x, y, 0);

      scene.add(textMesh);
      textObjects.push(textMesh);
    });
  }

  // Function to handle mouse click events
  function onClick(event) {
    const canvas = renderer.domElement;
    const rect = canvas.getBoundingClientRect();
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;

    const vector = new THREE.Vector2((x / canvas.clientWidth) * 2 - 1, -(y / canvas.clientHeight) * 2 + 1);
    raycaster.setFromCamera(vector, camera);
    const intersects = raycaster.intersectObjects(scene.children);

    if (intersects.length === 0) {
      const textInput = document.getElementById('text-input');
      const text = textInput.value.trim();

      if (text !== '') {
        createTextObject(text, x, y);
        // textInput.value = '';
      }
    }
  }

  // Initialize the scene, camera, and renderer
  function init() {
    scene = new THREE.Scene();

    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.z = 30;

    renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    mouse = new THREE.Vector2();
    raycaster = new THREE.Raycaster();

    document.addEventListener('click', onClick, false);
  }

  // Animate the scene
  function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
  }

  // Start the application
  init();
  animate();
</script>
</body>
</html>
