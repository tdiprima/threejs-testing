<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Document</title>
  <!-- https://discourse.threejs.org/t/three-meshfacematerial-has-been-removed-use-an-array-instead-doesnt-work/7020 -->
  <link href="/css/main.css" rel="stylesheet">
</head>
<body>
<script type="module">
  import * as THREE from "https://cdn.rawgit.com/mrdoob/three.js/r124/build/three.module.js";

  let camera, scene, renderer;
  let materials = [];

  init();
  animate();

  function init() {
    camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 1000);
    camera.position.z = 500;

    scene = new THREE.Scene();
    scene.background = new THREE.Color("#e6e6e6");

    let geometry = new THREE.PlaneGeometry(300, 150, 5, 3);

    let materials = [];
    let green = 0;
    let length = geometry.faces.length / 2;
    for (let y = 0; y < length; ++y) {
      let j = 2 * y; // j = vertex index
      // It's supposed to go from green to yellow
      let colorname = `rgb(${green}, 200, 40)`;

      let colorvar = new THREE.Color(colorname);
      let material = new THREE.MeshBasicMaterial({color: colorvar, side: THREE.DoubleSide});
      materials.push(material);
      geometry.faces[j].materialIndex = y;
      geometry.faces[j + 1].materialIndex = y;
      green += 15;
    }

    // THREE.MeshFaceMaterial has been removed. Use an Array instead.
    // let multiMaterial = new THREE.MeshFaceMaterial(materials);
    // let mesh = new THREE.Mesh(geometry, multiMaterial);
    let mesh = new THREE.Mesh(geometry, materials);
    scene.add(mesh);

    renderer = new THREE.WebGLRenderer({antialias: true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);
  }

  function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
  }
</script>
</body>
</html>
